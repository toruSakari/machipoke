# マチポケ API 概要

## はじめに

マチポケ（MachiPoke）APIは、「地元の人だけが知る場所を共有するプラットフォーム」を構築するための包括的なインターフェースを提供します。このAPIを使用することで、アプリケーションは隠れた名所、穴場スポット、特別な場所を検索、作成、更新できるようになります。

マチポケAPIはGraphQLベースで設計されており、フロントエンドアプリケーションが必要とする正確なデータを効率的に取得できるよう最適化されています。詳細な実装に関しては[GraphQL API設計](/docs/architecture/api.md)を参照してください。

## APIエンドポイント

**GraphQL エンドポイント**：
```
https://api.machipoke.app/graphql
```

**開発環境エンドポイント**：
```
http://localhost:8787/graphql
```

## 認証

マチポケAPIは、JWT（JSON Web Token）ベースの認証を使用しています。ほとんどのAPIオペレーションでは、リクエストヘッダーに有効な認証トークンを含める必要があります。

```
Authorization: Bearer <your_jwt_token>
```

認証の詳細については、[認証ドキュメント](./authentication.md)を参照してください。

## 主要機能

マチポケAPIは以下の主要機能をサポートしています：

### 1. スポット管理

- スポットの検索（位置情報、カテゴリ、キーワードベース）
- スポットの作成、更新、削除
- スポット画像のアップロードと管理
- スポットへのコメント追加と表示

### 2. ユーザー管理

- ユーザー登録とログイン
- プロフィール管理
- ユーザー作成のスポット表示

### 3. カテゴリ

- カテゴリ一覧の取得
- カテゴリ別スポットの検索

### 4. 保存リスト

- ユーザーの保存リスト作成と管理
- 「行ってみたい」「行った」スポットのマーキング

## レート制限

APIはレート制限を設けています。制限を超えるとリクエストが拒否されます。

- 認証済みユーザー: 60 リクエスト/分
- 非認証ユーザー: 30 リクエスト/分

詳細については、[レート制限ドキュメント](./rate-limiting.md)を参照してください。

## エラー処理

マチポケAPIは、標準的なGraphQLエラー形式でエラーを返します。一般的なエラーコードとその対処法については、[エラー処理ドキュメント](./error-handling.md)を参照してください。

## トラブルシューティング

APIの使用中に問題が発生した場合は、以下を確認してください：

1. 認証トークンが有効かつ期限切れでないこと
2. リクエストの形式が正しいこと
3. 必須フィールドがすべて含まれていること
4. レート制限を超えていないこと

それでも問題が解決しない場合は、[サポートページ](https://machipoke.app/support)にお問い合わせください。

## 関連ドキュメント

- [GraphQLスキーマ](./schema.md)
- [クエリ](./queries.md)
- [ミューテーション](./mutations.md)
- [認証](./authentication.md)
- [エラー処理](./error-handling.md)
- [ページネーション](./pagination.md)
- [レート制限](./rate-limiting.md)
- [バージョニング](./versioning.md)
